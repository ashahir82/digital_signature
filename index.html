<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <title>Tandatangan Digital</title>

    <!-- Signature Pad CDN -->
     <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="js/signature_pad.umd.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f6fa;
            padding: 40px;
        }
        .card {
            background: #fff;
            padding: 20px;
            width: 600px;
            margin: auto;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,.1);
        }
        canvas {
            
            border: 1px solid #ccc;
            width: 100%;
            height: 200px;
        }
        .btn {
            padding: 10px 16px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
        .btn-clear {
            background: #e74c3c;
            color: #fff;
        }
        .btn-save {
            background: #2ecc71;
            color: #fff;
        }
        .btn-group {
            margin-top: 15px;
            text-align: right;
        }
    </style>
</head>
<body>

<div class="card">
    <h2>Tandatangan Digital</h2>
    <p>Sila tandatangan di ruang bawah</p>

    <canvas id="signature-pad"></canvas>

    <div class="btn-group">
        <button class="btn btn-clear" onclick="clearPad()">Clear</button>
        <button class="btn btn-save" onclick="saveSignature()">Simpan Tandatangan</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('signature-pad');

    // auto resize canvas ikut screen
    function resizeCanvas() {
        const ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        canvas.getContext("2d").scale(ratio, ratio);
    }
    window.onresize = resizeCanvas;
    resizeCanvas();

    const signaturePad = new SignaturePad(canvas);

    function clearPad() {
        signaturePad.clear();
    }

    function saveSignature() {
        if (signaturePad.isEmpty()) {
            alert('Sila tandatangan dahulu');
            return;
        }

        const dataURL = signaturePad.toDataURL('image/png');

        fetch('save_signature.php', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                signature: dataURL,
                document_id: 1   // contoh ID dokumen
            })
        })
        .then(res => res.json())
        .then(data => {
            if (data.status === 'ok') {
                alert('Tandatangan berjaya disimpan');
                signaturePad.clear();
            } else {
                alert('Gagal simpan tandatangan');
            }
        });
    }
</script>

</body>
</html>
